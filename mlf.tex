\section{Иерархические обобщенные линейные модели}


\subsection{Определение MLF}

Для начала, стоит определиться, что какие переменные мы рассматриваем как многоуровневые (multi-level). 
Мы будем называть фактор многоуровневым, если он имеет относительно большое количество уровней, многие из которых не имеют много данных, при этом, уровни фактора не имеют никакого естественного порядка. 
приведём несколько примеров:



\begin{itemize}
	\item Населённый пункт. Является одним из самых важных факторов. Через него можуг внести эффект такие показатели, например, как качество дорог, по которым ездит страхователь, качество жизни горожан. Такие показатели имеют сильное влияние учет сильно повышает качество модели. Но здесь мы сталкиваемся с проблемой. В состав Российской Федерации входит более тысячи городов. При этом лишь по нескольким из них имеется достаточная статистика. Например, такие риски, как вероятность угона или тотальной гибели автомобиля сильно зависят от фактора населённый пункт. Но поскольку эти частоты имеют порядок 0.001, то для их учёта необходима статистика хотя бы несколько тысячь полисо-лет. Понятно, что далеко не каждый населённый пункт имеет такую статистическую базу. В этом примере показана основная проблема данной работы. С одной стороны, мало какие населённые пункты пункты имеют достаточно данных для учёта их как фактора. Но с другой стороны, если мы видим, что какой-то город с небольшой статистикой имеет очень большое влияние, скажем в нём частота ДТП Виновник намного больше чем в остальных, то не учитывать это влияние совсем было бы неправильно. 
	Можно было бы объеденить все небольшие города в один из одного региона или даже федерального округа для избежания небольших объёмов данных, но это приводит к другим проблемам: населённый пункт с большим средним доходом было бы неправильно объединять с неблагополучным соседним. Было бы разумнее объединить его  с похожим населённым пунктом из другого региона. Поэтому этот фактор остаётся многоуровневым.
	\item Модель автомобиля. Это один из самых важных факторов в тарификации тоже. Здесь возникают проблемы схожие с населённым пунктом. Какие-то модели более привлекательны для угона, какие-то редкие модели дороже ремонтировать при обычных ДТП, или владельцы каких-то марок более склонны к тем или иным ДТП. Очевидно, уровни фактора не образуют никакого естественного порядка. При этом их очень много и лишь несколько самых популярных из них имеют не слишком маленькую долю.

\end{itemize}
	В примере с населённым пунктом была поставлена основная проблема. Есть некоторые уровни многоуровневого фактора, которые неправильно было бы учитывать обычным для обобщенных линейных моделей образом, поскольку для них слишком мало статистики. Но но не учитывать их совсем тоже неправильно, если они имеют большой эффект. Здесь нам нужно найти некоторый компромисс между этими подходами. 
	
	
\subsection{Частичное решение проблем MLF}
	Проблемы малых групп, описанные выше, частично решаются использованием других переменных, которые частично объясняют влияние MLF. Например, для многоуровневого фактора "Модель авто" такими факторами могут  являться "мощность", "страховая сумма", "количество мест", "класс ТС", "масса ТС" и так далее.Такие характеристики автомобиля хорошо объясняют "индивидуальность" данной модели. Более того, мощность даёт немного более широкое данные, т.к. у моделей существуют различные комплектации. Этот поход улучшает предсказательную силу модели, но, как показывает практика, не описывает всю картину. Рассмотрим сказанное на примере.
	Рассмотрим модель частоты ДТП Виновник. Посмотрим на распределение частот по маркам и моделям. Попробуем включить в модель факторы "Период", "Мощность авто", "Класс ТС", "Возраст ТС", "Страховая сумма". 
	
	\includegraphics[scale=0.5]{data/distr_brand}
	
	
	\includegraphics[scale=0.5]{data/distr_model}
		

	
	На графиках видно, что эти факторы неплохо объясняют влияние "Модель авто" и "Марка авто", но всё ещё есть серьёзные отклонения. Безусловно, это делеко не все факторы, которые имеют корреляцию с факторами 
	'Марка авто' и 'Модель Авто'. например, некоторые марки почти не встречаются вне города, поэтому их влияние может частично объясниться и фактором 'Тип населённого пункта' , но тем не менее, полностью эти факторы необъяснятся и поэтому придётся иметь дело с этими многоуровнемы факторами. 
	
	